<div class="product-detail-container">
  <div class="product-content">

    <div class="image-section">
      <div class="main-image">
        <img [src]="selectedImage || produit.image" [alt]="produit.nom" />
       <button 
  class="favorite-btn" 
  [class.active]="estFavori(produit)" 
  (click)="produit.enStock ? toggleFavori(produit) : null"
  [style.pointer-events]="!produit.enStock ? 'none' : 'auto'"
  [style.opacity]="!produit.enStock ? '0.4' : '1'"
  title="{{ produit.enStock ? 'Ajouter aux favoris' : 'Indisponible' }}"
>
  <fa-icon 
    [icon]="faHeart" 
    [ngClass]="{ 'favori-plein': estFavori(produit) }">
  </fa-icon>
</button>

      </div>

      <!-- Palette de couleurs -->
      <div class="color-selection" *ngIf="produit.couleurImages?.length">
        <h4>Couleurs disponibles</h4>
        <div class="color-palette">
          <div
            class="color-dot"
            *ngFor="let item of produit.couleurImages"
            [style.backgroundColor]="item.color"
            [class.selected]="selectedColor === item.color"
            (click)="selectColorImage(item.image, item.color)"
          ></div>
        </div>
      </div>

      <!-- ✅ Caractéristiques (à gauche) -->
      <div class="specifications" *ngIf="produit.caracteristiques?.length">
        <h3>Caractéristiques</h3>
        <div class="spec-grid">
          <div class="spec-item" *ngFor="let spec of produit.caracteristiques">
            <span class="spec-label">{{ spec.nom }}:</span>
            <span class="spec-value">{{ spec.valeur }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- COLONNE DROITE -->
    <div class="info-section">
      <div class="product-header">
        <h1>{{ produit.nom }}</h1>
      </div>

      <div class="price-section">
  <div *ngIf="produit.prixPromotion > 0; else prixNormal">
    <div class="text-2xl font-bold text-green-600">
      {{ produit.prixPromotion }} MAD
    </div>
    <div class="text-red-500 line-through text-sm">
      {{ produit.prix }} MAD
    </div>
  </div>

  <ng-template #prixNormal>
    <div class="text-2xl font-bold text-black">
      {{ produit.prix }} MAD
    </div>
  </ng-template>

  <div *ngIf="produit.prixPromotion > 0"
       class="absolute top-2 left-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow-lg">
    Promo
  </div>

  <div class="stock-info" [class.in-stock]="produit.enStock">
    <span *ngIf="produit.enStock">✓ En stock</span>
    <span *ngIf="!produit.enStock">✗ Rupture de stock</span>
  </div>
</div>


      <!-- ✅ Description (à droite) -->
      <div class="description" *ngIf="produit.description">
        <h3>Description</h3>
        <p>{{ produit.description }}</p>
      </div>

      <div class="delivery-info" *ngIf="produit.garantie">
        <div class="info-item">
          <strong>Garantie:</strong> {{ produit.garantie }}
        </div>
      </div>

      <div class="purchase-section">
        <div class="quantity-selector">
          <label>Quantité:</label>
          <div class="qty-controls">
            <button (click)="decrementQuantite(produit.id)" class="qty-btn">−</button>
            <span class="qty-value">{{ quantites[produit.id] }}</span>
            <button (click)="incrementQuantite(produit.id)" class="qty-btn">+</button>
          </div>
        </div>

        <div class="action-buttons">
          <button 
            class="add-to-cart-btn" 
            (click)="ajouterAuPanier(produit)" 
            [disabled]="!produit.enStock">
            <fa-icon [icon]="faCartShopping"></fa-icon>
            <span>Ajouter au panier</span>
          </button>
        </div>
      </div>
    </div>

  </div>
</div>
